using fused AdamW: False
iter 1: loss 4.2429 time 1740.67ms
iter 2: loss 4.2390 time 1503.94ms
iter 3: loss 4.1409 time 1540.52ms
iter 4: loss 4.0039 time 1440.26ms
iter 5: loss 3.9328 time 1480.45ms
iter 6: loss 3.8548 time 1592.44ms
iter 7: loss 3.7645 time 1705.63ms
iter 8: loss 3.7146 time 1528.67ms
iter 9: loss 3.6799 time 1502.28ms
iter 10: loss 3.5662 time 1531.60ms
save check point to out: iter 10 loss 3.5662 loss_val 3.5874
iter 11: loss 3.6394 time 2209.01ms
iter 12: loss 3.5402 time 1422.32ms
iter 13: loss 3.4768 time 1599.58ms
iter 14: loss 3.4487 time 1719.01ms
iter 15: loss 3.3365 time 1446.25ms
iter 16: loss 3.3007 time 1463.60ms
iter 17: loss 3.2618 time 1421.85ms
iter 18: loss 3.2967 time 1478.18ms
iter 19: loss 3.4298 time 1499.25ms
iter 20: loss 3.3871 time 1926.87ms
save check point to out: iter 20 loss 3.3871 loss_val 3.3428
iter 21: loss 3.1937 time 2295.13ms
iter 22: loss 3.2000 time 1635.45ms
iter 23: loss 3.3758 time 1692.76ms
iter 24: loss 3.3330 time 1634.09ms
iter 25: loss 3.2609 time 1592.21ms
iter 26: loss 3.2527 time 1456.99ms
iter 27: loss 3.2039 time 1407.91ms
iter 28: loss 3.2535 time 1439.23ms
iter 29: loss 3.0617 time 1393.07ms
iter 30: loss 3.1336 time 1409.33ms
save check point to out: iter 30 loss 3.1336 loss_val 3.1049
iter 31: loss 3.1319 time 2238.46ms
iter 32: loss 3.1105 time 1483.69ms
iter 33: loss 3.0686 time 1527.75ms
iter 34: loss 3.0153 time 1517.66ms
iter 35: loss 3.0519 time 1517.40ms
iter 36: loss 3.0397 time 1458.70ms
iter 37: loss 3.0027 time 1467.55ms
iter 38: loss 2.9810 time 1459.04ms
iter 39: loss 2.9338 time 1556.76ms
iter 40: loss 2.9351 time 1454.14ms
save check point to out: iter 40 loss 2.9351 loss_val 2.9356
iter 41: loss 3.0464 time 2569.33ms
iter 42: loss 3.0670 time 1444.18ms
iter 43: loss 2.9415 time 1429.64ms
iter 44: loss 2.8193 time 1445.42ms
iter 45: loss 2.8371 time 1433.04ms
iter 46: loss 2.8136 time 1406.10ms
iter 47: loss 2.7702 time 1437.07ms
iter 48: loss 2.7828 time 1443.23ms
iter 49: loss 2.7043 time 1437.58ms
iter 50: loss 2.7632 time 1432.21ms
save check point to out: iter 50 loss 2.7632 loss_val 2.7413
iter 51: loss 2.7203 time 2261.76ms
iter 52: loss 2.6687 time 1472.13ms
iter 53: loss 2.6845 time 1472.31ms
iter 54: loss 2.6476 time 1438.23ms
iter 55: loss 2.6898 time 1440.62ms
iter 56: loss 2.6826 time 1688.47ms
iter 57: loss 2.7169 time 1632.33ms
iter 58: loss 2.5959 time 1634.96ms
iter 59: loss 2.6215 time 1598.76ms
iter 60: loss 2.6108 time 1440.86ms
save check point to out: iter 60 loss 2.6108 loss_val 2.6406
iter 61: loss 2.6229 time 2500.75ms
iter 62: loss 2.6550 time 1608.75ms
iter 63: loss 2.6848 time 1487.21ms
iter 64: loss 2.5686 time 1498.37ms
iter 65: loss 2.4812 time 1596.55ms
iter 66: loss 2.6033 time 1489.85ms
iter 67: loss 2.5587 time 1552.72ms
iter 68: loss 2.5440 time 1440.69ms
iter 69: loss 2.5956 time 1471.75ms
iter 70: loss 2.5300 time 1459.13ms
save check point to out: iter 70 loss 2.5300 loss_val 2.5872
iter 71: loss 2.6467 time 2246.86ms
iter 72: loss 2.7143 time 1449.07ms
iter 73: loss 2.5648 time 1412.47ms
iter 74: loss 2.5973 time 1415.79ms
iter 75: loss 2.5567 time 1415.74ms
iter 76: loss 2.4682 time 2062.89ms
iter 77: loss 2.5126 time 1484.22ms
iter 78: loss 2.5205 time 1427.04ms
iter 79: loss 2.5287 time 1464.49ms
iter 80: loss 2.5227 time 1451.97ms
save check point to out: iter 80 loss 2.5227 loss_val 2.5097
iter 81: loss 2.4431 time 2304.87ms
iter 82: loss 2.6051 time 1426.88ms
iter 83: loss 2.5206 time 1670.49ms
iter 84: loss 2.5326 time 1397.48ms
iter 85: loss 2.5709 time 1435.50ms
iter 86: loss 2.5630 time 1425.06ms
iter 87: loss 2.4698 time 1424.68ms
iter 88: loss 2.6062 time 1463.39ms
iter 89: loss 2.4001 time 1576.84ms
iter 90: loss 2.4842 time 1914.80ms
save check point to out: iter 90 loss 2.4842 loss_val 2.4980
iter 91: loss 2.5951 time 2944.69ms
iter 92: loss 2.4991 time 1578.99ms
iter 93: loss 2.5709 time 1710.30ms
iter 94: loss 2.5000 time 1504.10ms
iter 95: loss 2.5569 time 1521.22ms
iter 96: loss 2.5098 time 1563.26ms
iter 97: loss 2.5025 time 1767.58ms
iter 98: loss 2.5484 time 2022.79ms
iter 99: loss 2.5539 time 1712.88ms
iter 100: loss 2.5409 time 1503.41ms
save check point to out: iter 100 loss 2.5409 loss_val 2.4826
iter 101: loss 2.4121 time 2689.97ms
iter 102: loss 2.7376 time 1802.12ms
iter 103: loss 3.0485 time 1552.75ms
iter 104: loss 3.0682 time 1795.97ms
iter 105: loss 2.8643 time 1553.70ms
iter 106: loss 2.7887 time 1454.41ms
iter 107: loss 2.7988 time 1469.09ms
iter 108: loss 2.7578 time 1467.88ms
iter 109: loss 2.6117 time 1484.40ms
iter 110: loss 2.7740 time 1500.49ms
save check point to out: iter 110 loss 2.7740 loss_val 2.6508
iter 111: loss 2.5840 time 2305.25ms
iter 112: loss 2.5973 time 1482.07ms
iter 113: loss 2.6226 time 1485.33ms
iter 114: loss 2.6335 time 1805.61ms
iter 115: loss 2.5580 time 1475.29ms
iter 116: loss 2.5613 time 1488.02ms
iter 117: loss 2.6445 time 1437.11ms
iter 118: loss 2.5290 time 1436.79ms
iter 119: loss 2.4811 time 1455.97ms
iter 120: loss 2.4748 time 1439.19ms
save check point to out: iter 120 loss 2.4748 loss_val 2.5366
iter 121: loss 2.5596 time 2455.71ms
iter 122: loss 2.4867 time 1795.70ms
iter 123: loss 2.5232 time 1540.25ms
iter 124: loss 2.4746 time 1512.33ms
iter 125: loss 2.4572 time 1709.26ms
iter 126: loss 2.4813 time 1765.13ms
iter 127: loss 2.5220 time 1570.88ms
iter 128: loss 2.4619 time 1762.05ms
iter 129: loss 2.4336 time 1623.48ms
iter 130: loss 2.4531 time 1713.33ms
save check point to out: iter 130 loss 2.4531 loss_val 2.4423
iter 131: loss 2.4078 time 2547.28ms
iter 132: loss 2.4175 time 1491.33ms
iter 133: loss 2.3024 time 1558.60ms
iter 134: loss 2.4394 time 1760.27ms
iter 135: loss 2.4513 time 1545.63ms
iter 136: loss 2.3371 time 1634.88ms
iter 137: loss 2.3542 time 1546.93ms
iter 138: loss 2.3678 time 1479.20ms
iter 139: loss 2.4153 time 1480.50ms
iter 140: loss 2.3761 time 1477.00ms
save check point to out: iter 140 loss 2.3761 loss_val 2.3764
iter 141: loss 2.3719 time 2356.12ms
iter 142: loss 2.3598 time 1469.28ms
iter 143: loss 2.2826 time 1488.25ms
iter 144: loss 2.2475 time 1472.77ms
iter 145: loss 2.3340 time 1493.57ms
iter 146: loss 2.2624 time 1516.00ms
iter 147: loss 2.3471 time 1489.34ms
iter 148: loss 2.2910 time 1544.86ms
iter 149: loss 2.2205 time 1643.61ms
iter 150: loss 2.2673 time 1673.32ms
save check point to out: iter 150 loss 2.2673 loss_val 2.3068
iter 151: loss 2.2667 time 2912.78ms
iter 152: loss 2.2454 time 1668.27ms
iter 153: loss 2.2678 time 1485.71ms
iter 154: loss 2.3338 time 1683.34ms
iter 155: loss 2.2071 time 1466.09ms
iter 156: loss 2.2679 time 1437.07ms
iter 157: loss 2.2061 time 1471.77ms
iter 158: loss 2.1990 time 1480.54ms
iter 159: loss 2.2334 time 1509.53ms
iter 160: loss 2.2649 time 1589.46ms
save check point to out: iter 160 loss 2.2649 loss_val 2.2523
iter 161: loss 2.2115 time 2740.58ms
iter 162: loss 2.2107 time 1504.53ms
iter 163: loss 2.2249 time 2858.35ms
iter 164: loss 2.1983 time 2509.32ms
iter 165: loss 2.2173 time 1741.34ms
iter 166: loss 2.2649 time 1540.23ms
iter 167: loss 2.2817 time 1489.38ms
iter 168: loss 2.2769 time 1936.35ms
iter 169: loss 2.2016 time 1465.38ms
iter 170: loss 2.1595 time 1525.37ms
save check point to out: iter 170 loss 2.1595 loss_val 2.2263
iter 171: loss 2.1988 time 2547.87ms
iter 172: loss 2.1926 time 1544.71ms
iter 173: loss 2.2138 time 1447.03ms
iter 174: loss 2.1569 time 1734.03ms
iter 175: loss 2.1629 time 2029.45ms
iter 176: loss 2.1612 time 1983.36ms
iter 177: loss 2.1521 time 1632.16ms
iter 178: loss 2.1073 time 1446.37ms
iter 179: loss 2.2307 time 2269.57ms
iter 180: loss 2.1853 time 2102.14ms
save check point to out: iter 180 loss 2.1853 loss_val 2.1853
iter 181: loss 2.0493 time 3546.46ms
iter 182: loss 2.1301 time 2143.06ms
iter 183: loss 2.1584 time 1630.52ms
iter 184: loss 2.2632 time 2110.59ms
iter 185: loss 2.0644 time 1564.65ms
iter 186: loss 2.1751 time 1821.73ms
iter 187: loss 2.1367 time 1543.75ms
iter 188: loss 2.0719 time 1565.71ms
iter 189: loss 2.1473 time 1665.53ms
iter 190: loss 2.1121 time 1828.24ms
save check point to out: iter 190 loss 2.1121 loss_val 2.1654
iter 191: loss 2.0439 time 2681.81ms
iter 192: loss 2.1283 time 1476.37ms
iter 193: loss 2.2279 time 1864.94ms
iter 194: loss 2.1428 time 1666.56ms
iter 195: loss 2.1015 time 1668.55ms
Traceback (most recent call last):
  File "/Users/xiaom/Documents/Projects/MyGPT/train.py", line 19, in <module>
    train(model, train_config, dataset)
  File "/Users/xiaom/Documents/Projects/MyGPT/trainer.py", line 52, in train
    logits, loss = model.forward(input, target)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiaom/Documents/Projects/MyGPT/model.py", line 213, in forward
    embd = block(embd)
           ^^^^^^^^^^^
  File "/Users/xiaom/Programs/miniconda3/envs/py3-11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiaom/Documents/Projects/MyGPT/model.py", line 148, in forward
    result = result + self.ffn(self.ln(result))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiaom/Programs/miniconda3/envs/py3-11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiaom/Documents/Projects/MyGPT/model.py", line 114, in forward
    result = self.layer_1(input) 
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/xiaom/Programs/miniconda3/envs/py3-11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiaom/Programs/miniconda3/envs/py3-11/lib/python3.11/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
